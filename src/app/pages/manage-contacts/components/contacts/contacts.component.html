<section class="py-3 px-1 d-flex flex-column gap-3">
  <div class="d-flex justify-content-between align-items-center ">
    <div class="d-flex position-relative row m-0">
      <div class=" col-12 col-lg-4 p-0">
        <input #search type="text" class="form-control ps-5  txt-xs" id="search" placeholder="Search" (keyup)="onSearch(search)">
      </div>
      <div class="icon px-4 w-fit position-absolute start-0 top-50 translate-middle-y">
        <img src="assets/icons/search.svg" alt="" width="14">
      </div>
      <!-- <mat-icon class="w-fit text-neutral-500 position-absolute start-0 top-50 translate-middle-y">search</mat-icon> -->
    </div>

    <mat-form-field class="us-select">
      <mat-label class="txt-caption"> <img src="assets/icons/display.svg" alt="" class="m-2" width="15"> <span class="txt-caption" style="font-size: 12px !important;">Display</span></mat-label>
      <mat-select [formControl]="columns"  (selectionChange)="changeColumns($event.value)" multiple>
        <mat-option *ngFor="let topping of displayed" [value]="topping">{{topping}}</mat-option>
      </mat-select>
    </mat-form-field>
  </div>

  <section class="table-wrapper ">
    <table matSort mat-table [dataSource]="dataSource" (matSortChange)="onSortChange($event)">
      <!-- Checkbox Column -->
      <ng-container matColumnDef="select">
        <th mat-header-cell *matHeaderCellDef>
          <mat-checkbox  color="ch-color"
          (change)="$event ? toggleAllRows() : null"
          [checked]="selection.hasValue() && isAllSelected()"
          [indeterminate]="selection.hasValue() && !isAllSelected()"
          [aria-label]="checkboxLabel()">
      </mat-checkbox>
        </th>
        <td mat-cell *matCellDef="let row">
          <mat-checkbox color="ch-color" (click)="$event.stopPropagation() && selectedRow($event) "
            (change)="$event ? this.selection.toggle(row): null"
            [checked]="selection.isSelected(row)"
            #check
            [aria-label]="checkboxLabel(row)">
          </mat-checkbox>
        </td>
      </ng-container>

      <!-- Name Column -->
      <ng-container matColumnDef="Name">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Name </th>
        <td mat-cell *matCellDef="let element"> {{element.name}} </td>
      </ng-container>

      <!-- Mobile Column -->
      <ng-container matColumnDef="Mobile">
        <th mat-header-cell *matHeaderCellDef > Mobile </th>
        <td mat-cell *matCellDef="let element"> {{element.mobileNumber}} </td>
      </ng-container>

      <!-- Notes Column -->
      <ng-container matColumnDef="Notes">
        <th mat-header-cell *matHeaderCellDef > Notes</th>
        <td mat-cell *matCellDef="let element"> {{element.note}} </td>
      </ng-container>

       <!-- Lists Column -->
       <ng-container matColumnDef="Lists">
        <th mat-header-cell *matHeaderCellDef > Lists </th>
        <td mat-cell *matCellDef="let element" > {{element.lists.name}}
  <div id="list">
         <div class="lists">
          <ng-container *ngFor="let list of element.lists">
          <span id="listName">
            {{list.name}}
          </span>
        </ng-container>

         </div>
         <div class="arrow d-flex align-items-center justify-content-end">
          <img src="assets/icons/arrow.svg" alt="">
        </div>
      </div>
        </td>
      </ng-container>

       <!-- Company Name Column -->
       <ng-container matColumnDef="Company Name">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Company Name </th>
        <td mat-cell *matCellDef="let element"> {{element.companyName}} </td>
      </ng-container>


       <!-- Create At Column -->
       <ng-container matColumnDef="Create At">
        <th mat-header-cell *matHeaderCellDef >  Create At </th>
        <td mat-cell *matCellDef="let element"> {{element.createdAt| date: 'd MMM y'}} </td>
      </ng-container>

       <!-- Action Column -->
       <ng-container matColumnDef="action">
        <th mat-header-cell *matHeaderCellDef> Action </th>
        <td mat-cell *matCellDef="let element">

            <div class="d-flex align-items-center pointer text-primary-800" (click)="openEditModal(element)">

                <mat-icon class="mat-icon" color="primary" >edit</mat-icon>
                <span class="txt-sm edit">Edit</span>
            </div>
          </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns;" ></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;let i = index;"
        [ngClass]="{'active-row':checks?._results[i]?.checked}"
        >
      </tr>
    </table>
    <mat-paginator
    (page)="onPageChange($event)"
    [pageSizeOptions]="[5, 10, 20]"
    [length]="length"
        showFirstLastButtons
        aria-label="Select page of periodic elements">
    </mat-paginator>
  </section>

</section>
<!-- <div class="undo-delete d-flex justify-content-between align-items-center p-4 txt-lg bg-neutral-0 position-relative" *ngIf="deletedContacts.length!=0">
  <span class="items">{{deletedContacts.length}} Item(s) Deleted</span>
  <span class="undo text-primary-800" (click)="undoDelete()">Undo</span>
  <mat-icon class="position-absolute top-0 end-0 m-3 pointer" (click)="onTagClose($event)">close</mat-icon>

</div> -->
<div class="undo-delete txt-lg bg-neutral-0" *ngIf="deletedContacts.length!=0">
  <div class="close d-flex justify-content-end align-items-center my-2 px-2" (click)="onClose()">  <mat-icon >close</mat-icon>
  </div>
<div class=" d-flex justify-content-between align-items-center px-4 " >
  <span class="items">{{deletedContacts.length}} Item(s) Deleted</span>
  <span class="undo text-primary-800" (click)="undoDelete()">Undo</span>

</div>
</div>
